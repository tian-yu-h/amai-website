---
import Layout from "@layouts/Layout.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import { getCollection } from "astro:content";

// Fetch blog posts safely
let recentPosts = [];
try {
  const posts = await getCollection("blog");
  const sortedPosts = posts.sort(
    (a, b) => new Date(b.data.pubDatetime).valueOf() - new Date(a.data.pubDatetime).valueOf()
  );
  recentPosts = sortedPosts.slice(0, 3);
} catch (e) {
  console.log("No blog posts found yet.");
}
---

<Layout>
  <Header />

  <main id="main-content" class="use-utility-layout max-w-6xl mx-auto px-4">
    
    <!-- SECTION 1: HERO -->
    <section id="hero" class="pt-24 pb-16">
      <h1 class="text-4xl sm:text-5xl font-bold mb-6 text-skin-base tracking-tight leading-tight">
        Bridging Sensory Science <br class="hidden sm:block" />& Artificial Intelligence.
      </h1>
      <p class="text-lg mb-10 text-skin-muted leading-relaxed max-w-2xl">
        I help F&B and CPG companies assess digital readiness and discover opportunities through authentic consumer insights. 
        <span class="block mt-2 font-medium text-skin-base">No hype, just grounded science.</span>
      </p>
      
      <div class="flex flex-wrap gap-4">
        <a href="mailto:your-email@example.com" 
           class="px-6 py-3 bg-skin-accent text-skin-inverted rounded-md font-medium hover:opacity-90 transition shadow-sm">
           Contact Me
        </a>
        <a href="https://linkedin.com/in/yourprofile" 
           target="_blank"
           class="px-6 py-3 border border-skin-line text-skin-base rounded-md font-medium hover:bg-skin-card-muted transition">
           LinkedIn
        </a>
      </div>
    </section>

    <hr class="border-skin-line my-12 opacity-50" />

    <!-- SECTION 2: SERVICES -->
    <section id="services" class="py-8">
      <h2 class="text-2xl font-bold mb-8 text-skin-base">Consulting Services</h2>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="p-6 rounded-xl border border-skin-line bg-skin-card hover:border-skin-accent transition-colors duration-300">
          <h3 class="text-lg font-bold mb-3 text-skin-accent">AI Readiness</h3>
          <p class="mb-4 text-sm text-skin-muted leading-relaxed">
            Navigating the noise of AI services specifically for the Food & Beverage industry. 
          </p>
        </div>

        <div class="p-6 rounded-xl border border-skin-line bg-skin-card hover:border-skin-accent transition-colors duration-300">
          <h3 class="text-lg font-bold mb-3 text-skin-accent">Sensory Insights</h3>
          <p class="mb-4 text-sm text-skin-muted leading-relaxed">
            Discover opportunities from authentic consumer languages and behavior science.
          </p>
        </div>
      </div>
    </section>

    <hr class="border-skin-line my-12 opacity-50" />

    <!-- SECTION 3: CASE STUDIES -->
    <section id="recent-posts" class="pb-24">
      <div class="flex justify-between items-baseline mb-8">
        <h2 class="text-2xl font-bold text-skin-base">Case Studies</h2>
        <a href="/blog" class="text-sm font-semibold text-skin-accent hover:underline decoration-2 underline-offset-4">
          View All &rarr;
        </a>
      </div>
      <!-- Case Study List Code Here (Same as before) -->
      <div class="space-y-6">
        {recentPosts.length > 0 ? (
          recentPosts.map((post) => (
            <a href={`/blog/${post.slug}/`} class="group block">
              <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 border-b border-skin-line group-hover:border-skin-accent transition-colors">
                <h3 class="text-lg font-medium text-skin-base group-hover:text-skin-accent transition-colors">
                  {post.data.title}
                </h3>
              </div>
            </a>
          ))
        ) : (
          <p class="text-skin-muted italic">Research in progress.</p>
        )}
      </div>
    </section>
  </main>

  <Footer />
</Layout>